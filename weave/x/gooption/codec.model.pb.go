// Code generated by protoc-gen-gogo. DO NOT EDIT.
// source: codec.proto

package gooption

import github_com_iov_one_weave "github.com/iov-one/weave"
import github_com_iov_one_weave_orm "github.com/iov-one/weave/orm"
import github_com_jinzhu_copier "github.com/jinzhu/copier"
import proto "github.com/gogo/protobuf/proto"
import fmt "fmt"
import math "math"
import _ "github.com/gogo/protobuf/gogoproto"
import _ "github.com/lehajam/protoc-gen-weave/x/bucket"

// Reference imports to suppress errors if they are not otherwise used.
var _ = proto.Marshal
var _ = fmt.Errorf
var _ = math.Inf

func (b *Valuation) Copy() github_com_iov_one_weave_orm.CloneableData {
	var cpy *Valuation
	github_com_jinzhu_copier.Copy(cpy, b)
	return cpy
}

const ValuationBucketName = "valuations"

type ValuationBucket struct {
	github_com_iov_one_weave_orm.Bucket
	idSeq github_com_iov_one_weave_orm.Sequence
}

func NewValuationBucket() ValuationBucket {
	bucket := github_com_iov_one_weave_orm.NewBucket(ValuationBucketName,
		github_com_iov_one_weave_orm.NewSimpleObj(nil, new(Valuation))).
		WithIndex("publisher", idxPublisher, false).
		WithIndex("contract", idxContract, false)
	return ValuationBucket{Bucket: bucket}
}

func (b ValuationBucket) Save(db github_com_iov_one_weave.KVStore, obj github_com_iov_one_weave_orm.Object) error {
	if _, ok := obj.Value().(*Valuation); !ok {
		return github_com_iov_one_weave_orm.ErrInvalidObject(obj.Value())
	}
	return b.Bucket.Save(db, obj)
}

func idxPublisher(obj github_com_iov_one_weave_orm.Object) ([]byte, error) {
	if obj == nil {
		return nil, fmt.Errorf("Cannot take index of nil")
	}
	objAs, ok := obj.Value().(*Valuation)
	if !ok {
		return nil, fmt.Errorf("Can only take index of objAs")
	}
	return objAs.Publisher, nil
}
func idxContract(obj github_com_iov_one_weave_orm.Object) ([]byte, error) {
	if obj == nil {
		return nil, fmt.Errorf("Cannot take index of nil")
	}
	objAs, ok := obj.Value().(*Valuation)
	if !ok {
		return nil, fmt.Errorf("Can only take index of objAs")
	}
	return objAs.ContractId, nil
}
