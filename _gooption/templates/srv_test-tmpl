{{define "service"}}

// /* ----------------------------------------------------------------------------
//  * This file was automatically generated by gooption-cli.
//  * 
//  * This file contains test for each service and its associated request passed to gooption-cli
//  * Do not make changes to this file unless you know what you are doing--modify the gooption-cli
//  * tmpl file instead.
//  * ----------------------------------------------------------------------------- */

package {{.Package}}

import (
	context "golang.org/x/net/context"

	"os"
	"testing"

	"github.com/gogo/protobuf/jsonpb"
	"github.com/gooption/gobs/pb"
)

var (
	s = &server{}
)

{{range .Requests}}
func Test_{{.}}(t *testing.T) {
	if file, err := os.Open("./testdata/{{.}}Request.json"); err == nil {
		defer file.Close()
		request := &pb.{{.}}Request{}
		if jsonpb.Unmarshal(file, request) == nil {
			if response, err := s.{{.}}(context.Background(), request); err != nil {
				t.Log(response)
				t.Error(err)
				if response.Error != "" {
					t.Error(response.Error)
				}
			}
		} else {
			t.Error(err)			
		}
	} else {
		t.Error(err)					
	}
}
{{end}}
{{end}}